{% extends "layout.html" %}

{% block title %}Password Analyzer // Vault-Tec System{% endblock %}

{% block content %}
<div class="pipboy-screen">
    <div class="screen-border">
        <div class="scanlines"></div>
        
        <div class="terminal-header">
            <h1>// VAULT-TEC PASSWORD STRENGTH ANALYZER //</h1>
            <div class="subtitle">MODEL 3000 SECURITY SUITE</div>
            <div class="status-indicator"></div>
        </div>
        
        <div class="password-input-section">
            <label for="password-input" style="display: block; margin-bottom: 15px; font-size: 1.1em;">
                ENTER PASSWORD FOR ANALYSIS:
            </label>
            <div class="input-group">
                <input type="password" 
                       id="password-input" 
                       class="pipboy-input"
                       placeholder="ENTER SECURITY CODE"
                       autocomplete="off">
                <div class="input-beep"></div>
                <button type="button" class="password-toggle" style="position: absolute; right: 15px; top: 50%; transform: translateY(-50%); background: none; border: none; color: var(--pipboy-green); cursor: pointer; z-index: 2;">
                    üëÅÔ∏è
                </button>
            </div>
            
            <div class="strength-meter">
                <div class="meter-visual">
                    <div class="meter-bar" id="meter-bar"></div>
                    <div class="meter-glow" id="meter-glow"></div>
                </div>
                <div class="meter-labels">
                    <span>FAIL</span>
                    <span>WEAK</span>
                    <span>FAIR</span>
                    <span>GOOD</span>
                    <span>STRONG</span>
                </div>
            </div>
        </div>
        
        <div class="analysis-results" id="results-panel">
            <div class="result-header">
                <h2>ANALYSIS RESULTS:</h2>
                <div class="scan-id" id="scan-id">SCAN-ID: -----</div>
            </div>
            
            <div class="result-grid">
                <div class="result-item">
                    <span class="label">SECURITY RATING:</span>
                    <span class="value" id="security-rating">---</span>
                </div>
                <div class="result-item">
                    <span class="label">SCORE:</span>
                    <span class="value" id="score">0/100</span>
                </div>
                <div class="result-item">
                    <span class="label">STATUS:</span>
                    <span class="value" id="status">ANALYZING...</span>
                </div>
                <div class="result-item">
                    <span class="label">TIMESTAMP:</span>
                    <span class="value" id="timestamp">--:--:--</span>
                </div>
            </div>
            
            <div class="feedback-section">
                <h3>SECURITY FEEDBACK:</h3>
                <ul id="feedback-list">
                    <li>Enter password to begin analysis...</li>
                </ul>
            </div>
            
            <div class="dashboard-card mt-20">
                <h3>PASSWORD GUIDELINES:</h3>
                <div class="result-grid">
                    <div class="result-item">
                        <span class="label">MINIMUM LENGTH:</span>
                        <span class="value">8+ CHARACTERS</span>
                    </div>
                    <div class="result-item">
                        <span class="label">CHARACTER TYPES:</span>
                        <span class="value">4+ REQUIRED</span>
                    </div>
                    <div class="result-item">
                        <span class="label">COMMON WORDS:</span>
                        <span class="value" style="color: #FF3300;">AVOID</span>
                    </div>
                    <div class="meter-visual">
    <div class="meter-bar" id="meter-bar"></div>
    <div class="meter-glow" id="meter-glow"></div>
</div>
                    <div class="result-item">
                        <span class="label">SEQUENCES:</span>
                        <span class="value" style="color: #FF3300;">AVOID</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/password-meter.js') }}"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Password toggle
        const toggleBtn = document.querySelector('.password-toggle');
        const passwordInput = document.getElementById('password-input');
        
        toggleBtn.addEventListener('click', function() {
            const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
            passwordInput.setAttribute('type', type);
            this.textContent = type === 'password' ? 'üëÅÔ∏è' : 'üëÅÔ∏è‚Äçüó®Ô∏è';
            if (window.playSound) playSound('click');
        });
        
        // Initialize password analyzer
        if (window.passwordMeter) {
            const passwordInput = document.getElementById('password-input');
            passwordInput.addEventListener('input', function(e) {
                window.passwordMeter.analyzePassword(e.target.value);
            });
            
            // Clear on escape
            passwordInput.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    this.value = '';
                    window.passwordMeter.resetDisplay();
                    if (window.playSound) playSound('beep');
                }
            });
        }
        
        // Add sample password buttons
        const sampleContainer = document.createElement('div');
        sampleContainer.className = 'mt-20';
        sampleContainer.innerHTML = `
            <h4 style="color: var(--pipboy-highlight); margin-bottom: 10px;">TEST PASSWORDS:</h4>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <button class="pipboy-btn" onclick="testPassword('password')">password</button>
                <button class="pipboy-btn" onclick="testPassword('123456')">123456</button>
                <button class="pipboy-btn" onclick="testPassword('Vault2024')">Vault2024</button>
                <button class="pipboy-btn" onclick="testPassword('Vault-Tec2077!')">Vault-Tec2077!</button>
            </div>
        `;
        
        document.querySelector('.password-input-section').appendChild(sampleContainer);
    });
    
    function testPassword(password) {
        const input = document.getElementById('password-input');
        input.value = password;
        input.type = 'text';
        
        // Trigger analysis
        const event = new Event('input');
        input.dispatchEvent(event);
        
        if (window.playSound) playSound('beep');
        
        // Revert to password after 3 seconds
        setTimeout(() => {
            input.type = 'password';
        }, 3000);
    }
</script>
{% endblock %}